# PyPhyloGenomics: toolkit and protocol for developing phylogenetic markers in novel species for Next Generation Sequence data

## Introduction
Next Generation Sequencing (NGS) is considered a quantum leap in techniques for
DNA sequencing. The traditional Sanger method allows sequencing around \~1,000
bp per specimen in capillary-based machinery. This is almost meaningless when 
compared to the sequencing output of NGS technology: 30 gigabases of DNA in one
single run [@reis2009]. 
This higher yield is produced by using massive parallel sequencing of PCR
products based on DNA systhensis on arrays of micron-scale beads on planar 
substrates (a microchip) [@shendure2008].

The amount of DNA sequences used for phylogenetic inference is growing 

## Exon models 	
### Finding candidate genes from *Bombyx mori*

We need to obtain candidate genes to be used in phylogenetic inference that have to fulfill the following requirements:

* Our genes should be orthologs.
* Our genes should be single-copy genes.
* Their sequence need to be around 251 DNA base pairs in length.

We will assume that our Next Generation Sequencer available is the IonTorrent_.

We have to consider the IonTorrent_ platform requirements to arrive to our target 250bp gene length:

  Primer                Length (bp)
  --------------------  ------------
  Adapter A             30
  5' Index              8
  5' Degenerate Primer  25
  Exon                  **???**
  3' Degenerate Primer  25
  3' Index              8
  Adapter P             23
  --------------------  ------------

For IonTorrent <http://www.iontorrent.com/> Platform 2, the maximum length that can be sequenced is from 280bp to 320bp in total. Thus, ``320 - 119 = 201`` is the maximum internal gene region (region within degenerate primers).

Therefore, for the new set of primers, being designed for Platform2, we have a maximum amplicon size of ``201 + 25*2 = 251bp``. 

The OrthoDB <ftp://cegg.unige.ch/OrthoDB6/> database has a catalog of orthologous protein-coding genes for vertebrates, arthropods and other living groups.


## Action items
### Single Copy Genes
From OrthoDB and get a list of single-copy genes for *Bombyx mori*
Get the exon sequences from the CDS file for *Bombyx*
Use these CDS sequences to extract the corresponding sequence in the *Bombyx* genome avoiding gaps
so that we will only work with genes or gene fragments that do not include introns (which is good 
if you want to do phylogenetics).

## Exon Structure
Comparison against other butterfly and moth genomes 
Exon validation against genomes of *Manduca*, *Danaus* and *Heliconius*
 
## Exon Aligment and Primer Design
Need to get at least 4 sequences for primer desing using primers4clades [@contreras2009].

## Wet Lab
### Multiplex PCR
### Sample preparation for Next Generation Sequencing in IonTorrent

## Next Generation output analysis
### find barcodes
### find primers
### quality control of reads
### de novo assembly using velvet
### alignment and storage in VoSeq?
So that we can manage the high number of sequences and create datasets for phylogenetic analysis
very easily.

## Comparison with other methods
@regier2009, @regier2008, @regier2013 use Reverse Transcription PCR from mRNAs to avoid sequencing introns, although the corresponing genomic DNA sequences are  likely to include introns. Therefore if one use their genes, it is not recommended to do "direct gene amplification" [@regier2007].

# References
Targeted sequencing [@godden2012]



##software

*spidey
*CePrins?
*

